!function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function s(t){t.forEach(e)}function i(t){return"function"==typeof t}function o(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(e,n,s){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const s=e.subscribe(...n);return s.unsubscribe?()=>s.unsubscribe():s}(n,s))}function r(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function c(t){t.parentNode.removeChild(t)}function d(t){return document.createElement(t)}function u(t){return document.createTextNode(t)}function p(){return u(" ")}function f(){return u("")}function m(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function h(t){return function(e){return e.preventDefault(),t.call(this,e)}}function $(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function g(t){return""===t?null:+t}function b(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function y(t,e){t.value=null==e?"":e}function v(t,e,n,s){t.style.setProperty(e,n,s?"important":"")}function w(t,e){for(let n=0;n<t.options.length;n+=1){const s=t.options[n];if(s.__value===e)return void(s.selected=!0)}t.selectedIndex=-1}function x(t){const e={};for(const n of t)e[n.name]=n.value;return e}let _;function k(t){_=t}function I(){if(!_)throw new Error("Function called outside component initialization");return _}function E(t){I().$$.on_mount.push(t)}function N(){const t=I();return(e,n)=>{const s=t.$$.callbacks[e];if(s){const i=function(t,e,n=!1){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,!1,e),s}(e,n);s.slice().forEach((e=>{e.call(t,i)}))}}}function S(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const C=[],P=[],M=[],D=[],j=Promise.resolve();let F=!1;function L(t){M.push(t)}function R(t){D.push(t)}let q=!1;const A=new Set;function O(){if(!q){q=!0;do{for(let t=0;t<C.length;t+=1){const e=C[t];k(e),T(e.$$)}for(k(null),C.length=0;P.length;)P.pop()();for(let t=0;t<M.length;t+=1){const e=M[t];A.has(e)||(A.add(e),e())}M.length=0}while(C.length);for(;D.length;)D.pop()();F=!1,q=!1,A.clear()}}function T(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(L)}}const z=new Set;let H,V;function U(){H={r:0,c:[],p:H}}function G(){H.r||s(H.c),H=H.p}function Y(t,e){t&&t.i&&(z.delete(t),t.i(e))}function B(t,e,n,s){if(t&&t.o){if(z.has(t))return;z.add(t),H.c.push((()=>{z.delete(t),s&&(n&&t.d(1),s())})),t.o(e)}}function W(t,e){t.d(1),e.delete(t.key)}function X(t,e){B(t,1,1,(()=>{e.delete(t.key)}))}function K(t,e,n,s,i,o,l,r,a,c,d,u){let p=t.length,f=o.length,m=p;const h={};for(;m--;)h[t[m].key]=m;const $=[],g=new Map,b=new Map;for(m=f;m--;){const t=u(i,o,m),r=n(t);let a=l.get(r);a?s&&a.p(t,e):(a=c(r,t),a.c()),g.set(r,$[m]=a),r in h&&b.set(r,Math.abs(m-h[r]))}const y=new Set,v=new Set;function w(t){Y(t,1),t.m(r,d),l.set(t.key,t),d=t.first,f--}for(;p&&f;){const e=$[f-1],n=t[p-1],s=e.key,i=n.key;e===n?(d=e.first,p--,f--):g.has(i)?!l.has(s)||y.has(s)?w(e):v.has(i)?p--:b.get(s)>b.get(i)?(v.add(s),w(e)):(y.add(i),p--):(a(n,l),p--)}for(;p--;){const e=t[p];g.has(e.key)||a(e,l)}for(;f;)w($[f-1]);return $}function J(t,e,n){const s=t.$$.props[e];void 0!==s&&(t.$$.bound[s]=n,n(t.$$.ctx[s]))}function Q(t){t&&t.c()}function Z(t,n,o,l){const{fragment:r,on_mount:a,on_destroy:c,after_update:d}=t.$$;r&&r.m(n,o),l||L((()=>{const n=a.map(e).filter(i);c?c.push(...n):s(n),t.$$.on_mount=[]})),d.forEach(L)}function tt(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function et(t,e){-1===t.$$.dirty[0]&&(C.push(t),F||(F=!0,j.then(O)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function nt(e,i,o,l,r,a,d,u=[-1]){const p=_;k(e);const f=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:r,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(i.context||(p?p.$$.context:[])),callbacks:n(),dirty:u,skip_bound:!1,root:i.target||p.$$.root};d&&d(f.root);let m=!1;if(f.ctx=o?o(e,i.props||{},((t,n,...s)=>{const i=s.length?s[0]:n;return f.ctx&&r(f.ctx[t],f.ctx[t]=i)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](i),m&&et(e,t)),n})):[],f.update(),m=!0,s(f.before_update),f.fragment=!!l&&l(f.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);f.fragment&&f.fragment.l(t),t.forEach(c)}else f.fragment&&f.fragment.c();i.intro&&Y(e.$$.fragment),Z(e,i.target,i.anchor,i.customElement),O()}k(p)}var st;"function"==typeof HTMLElement&&(V=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(e).filter(i);for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){s(this.$$.on_disconnect)}$destroy(){tt(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});var it=new Uint8Array(16);function ot(){if(!st&&!(st="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return st(it)}var lt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function rt(t){return"string"==typeof t&&lt.test(t)}for(var at,ct,dt,ut,pt=[],ft=0;ft<256;++ft)pt.push((ft+256).toString(16).substr(1));function mt(t,e,n){var s=(t=t||{}).random||(t.rng||ot)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=s[i];return e}return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(pt[t[e+0]]+pt[t[e+1]]+pt[t[e+2]]+pt[t[e+3]]+"-"+pt[t[e+4]]+pt[t[e+5]]+"-"+pt[t[e+6]]+pt[t[e+7]]+"-"+pt[t[e+8]]+pt[t[e+9]]+"-"+pt[t[e+10]]+pt[t[e+11]]+pt[t[e+12]]+pt[t[e+13]]+pt[t[e+14]]+pt[t[e+15]]).toLowerCase();if(!rt(n))throw TypeError("Stringified UUID is invalid");return n}(s)}function ht(t){const e=+t;return"number"==typeof e&&!isNaN(e)&&e>0&&e.toFixed(0)===e.toString()}class $t{constructor(t=null,e={publicIPs:null,country:null,farmName:null,cru:null,mru:null,sru:null,update:(t,e)=>{this.filters[t]=e}},n=[]){this.type=t,this.filters=e,this.nodes=n}}class gt{constructor(t="NW"+mt().split("-")[0],e="10.20.0.0/16"){this.name=t,this.ipRange=e}get valid(){const{name:t,ipRange:e}=this;return""!==t&&""!==e}}class bt{constructor(t=mt(),e="",n=""){this.id=t,this.key=e,this.value=n}get valid(){const{key:t,value:e}=this;return""!==t&&""!==e}}class yt{constructor(t=mt(),e="VM"+t.split("-")[0],n="https://hub.grid.tf/tf-official-apps/base:latest.flist",s=4,i=8192,o="/sbin/zinit init",l=!0,r=null,a=25,c=new gt,d=[],u=[],p=!1,f=new $t){this.id=t,this.name=e,this.flist=n,this.cpu=s,this.memory=i,this.entrypoint=o,this.planetary=l,this.nodeId=r,this.rootFsSize=a,this.network=c,this.envs=d,this.disks=u,this.publicIp=p,this.selection=f}get valid(){const{name:t,flist:e,cpu:n,memory:s,entrypoint:i,nodeId:o}=this,{rootFsSize:l,network:r,envs:a,disks:c}=this;return""!==t&&""!==e&&""!==i&&ht(n)&&ht(s)&&ht(o)&&ht(l)&&r.valid&&a.reduce(((t,e)=>t&&e.valid),!0)&&c.reduce(((t,e)=>t&&e.valid),!0)}}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */async function vt(t,e){return 0==(await t.gateway.getObj(e)).length?e:e+Math.floor(1e3*Math.random())}const{HTTPMessageBusClient:wt}=null!==(ct=null===(at=window.configs)||void 0===at?void 0:at.client)&&void 0!==ct?ct:{},{DiskModel:xt,MachineModel:_t,MachinesModel:kt,GridClient:It,GatewayNameModel:Et,NetworkModel:Nt,Nodes:St}=null!==(ut=null===(dt=window.configs)||void 0===dt?void 0:dt.grid3_client)&&void 0!==ut?ut:{};let Ct,Pt;async function Mt(t,e){const n=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(t);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(t,s[i])&&(n[s[i]]=t[s[i]])}return n}(t,["envs","disks"]);let{name:s,flist:i,cpu:o,memory:l,entrypoint:r,network:a}=n;const{publicIp:c,planetary:d,nodeId:u,rootFsSize:p}=n,{mnemonics:f,storeSecret:m,networkEnv:h}=e,$=new wt(0,""),g=new It(h,f,m,$,void 0,"tfkvstore");await g.connect(),s=await vt(g,s),console.log(s);const b=new St(It.config.graphqlURL,It.config.rmbClient.proxyURL),y=await async function(t,e){const n=await async function(t){return await t.getAccessNodes()}(t);return n[e].domain}(b,8);Ct=`${s}.${y}`;const v=new Nt;v.name=s+"NW",v.ip_range="10.1.0.0/16",await async function(t,e,n,s,i){const o=new xt;o.name=e+"Disk",o.size=10,o.mountpoint="/data";const l=new _t;l.name=e,l.node_id=s,l.disks=[o],l.public_ip=!1,l.planetary=!0,l.cpu=4,l.memory=8192,l.rootfs_size=2,l.flist="https://hub.grid.tf/omar0.3bot/omarelawady-funk-latest.flist",l.entrypoint="/init.sh",l.env={FUNKWHALE_HOSTNAME:i};const r=new kt;return r.name=e,r.network=n,r.machines=[l],window.configs.currentDeploymentStore.deploy("Funkwhale",e),t.machines.deploy(r).then((t=>(window.configs.baseConfig.updateBalance(),t))).finally((()=>{window.configs.currentDeploymentStore.clear()}))}(g,s,v,u,Ct);const w=await async function(t,e){return await t.machines.getObj(e)}(g,s);Pt=w[0].planetary,await async function(t,e,n){const s=new Et;return s.name=e,s.node_id=8,s.tls_passthrough=!1,s.backends=[`http://[${n}]:80/`],window.configs.currentDeploymentStore.deploy("Funkwhale",e),t.gateway.deploy_name(s).finally((()=>{window.configs.currentDeploymentStore.clear()}))}(g,s,Pt),await async function(t,e){return await t.gateway.getObj(e)}(g,s)}function Dt(e){return{c(){this.c=t},m:t,p:t,i:t,o:t,d:t}}function jt(t){var e;const n=null===(e=window.configs)||void 0===e?void 0:e.baseConfig,s=N();let i;var o;return E((()=>{i=n.subscribe((()=>{s("profile",n.getActiveProfile())}))})),o=()=>{i()},I().$$.on_destroy.push(o),[]}class Ft extends V{constructor(t){super(),nt(this,{target:this.shadowRoot,props:x(this.attributes),customElement:!0},jt,Dt,o,{},null),t&&t.target&&a(t.target,this,t.anchor)}}function Lt(t,e,n){const s=t.slice();return s[24]=e[n],s}function Rt(t){let e,n,s;function i(t,e){return null==n&&(n=!!t[8]()),n?Ot:"checkbox"===t[1].type?At:"select"===t[1].type?qt:void 0}let o=i(t),l=o&&o(t),u=t[1].tooltip&&Wt(t);return{c(){e=d("div"),l&&l.c(),s=p(),u&&u.c(),$(e,"class","tooltip mb-2")},m(t,n){a(t,e,n),l&&l.m(e,null),r(e,s),u&&u.m(e,null)},p(t,n){o===(o=i(t))&&l?l.p(t,n):(l&&l.d(1),l=o&&o(t),l&&(l.c(),l.m(e,s))),t[1].tooltip?u?u.p(t,n):(u=Wt(t),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},d(t){t&&c(e),l&&l.d(),u&&u.d()}}}function qt(t){let e,n,i,o,l,u,f,h,g=[],b=new Map,y=t[1].label&&Tt(t),x=t[1].options;const _=t=>t[24].value;for(let e=0;e<x.length;e+=1){let n=Lt(t,x,e),s=_(n);b.set(s,g[e]=zt(s,n))}let k=(t[1].error||t[4])&&Ht(t);return{c(){y&&y.c(),e=p(),n=d("div"),i=d("select");for(let t=0;t<g.length;t+=1)g[t].c();l=p(),k&&k.c(),i.disabled=o=t[1].disabled,v(i,"width","100%"),void 0===t[0]&&L((()=>t[22].call(i))),$(n,"class",u="select mb-2"+(t[1].error||t[4]?" is-danger":"")),v(n,"width","100%"),$(n,"id",t[7])},m(s,o){y&&y.m(s,o),a(s,e,o),a(s,n,o),r(n,i);for(let t=0;t<g.length;t+=1)g[t].m(i,null);w(i,t[0]),r(n,l),k&&k.m(n,null),f||(h=[m(i,"change",t[22]),m(i,"change",t[9])],f=!0)},p(t,s){t[1].label?y?y.p(t,s):(y=Tt(t),y.c(),y.m(e.parentNode,e)):y&&(y.d(1),y=null),2&s&&(x=t[1].options,g=K(g,s,_,1,t,x,b,i,W,zt,null,Lt)),2&s&&o!==(o=t[1].disabled)&&(i.disabled=o),3&s&&w(i,t[0]),t[1].error||t[4]?k?k.p(t,s):(k=Ht(t),k.c(),k.m(n,null)):k&&(k.d(1),k=null),18&s&&u!==(u="select mb-2"+(t[1].error||t[4]?" is-danger":""))&&$(n,"class",u)},d(t){y&&y.d(t),t&&c(e),t&&c(n);for(let t=0;t<g.length;t+=1)g[t].d();k&&k.d(),f=!1,s(h)}}}function At(t){let e,n,i,o,l,f,h,g,y,w,x,_=t[1].label+"";return{c(){e=d("div"),n=d("label"),i=d("input"),l=p(),f=d("span"),h=p(),g=d("label"),y=u(_),$(i,"class","switch__input"),$(i,"type","checkbox"),$(i,"id",t[7]),i.disabled=o=t[1].disabled,$(f,"class","slider"),$(n,"class","switch"),$(g,"for",t[7]),$(g,"class","label ml-2"),v(g,"cursor","pointer"),v(e,"display","flex"),v(e,"align-items","center"),$(e,"class","mb-2")},m(s,o){a(s,e,o),r(e,n),r(n,i),i.checked=t[0],r(n,l),r(n,f),r(e,h),r(e,g),r(g,y),w||(x=[m(i,"change",t[21]),m(i,"input",t[14])],w=!0)},p(t,e){2&e&&o!==(o=t[1].disabled)&&(i.disabled=o),3&e&&(i.checked=t[0]),2&e&&_!==(_=t[1].label+"")&&b(y,_)},d(t){t&&c(e),w=!1,s(x)}}}function Ot(t){let e,n,s,i,o,l,f,m=t[1].label+"";function h(t,e){return"textarea"===t[1].type?Yt:"text"===t[1].type?Gt:"number"===t[1].type?Ut:"password"===t[1].type?Vt:void 0}let g=h(t),y=g&&g(t),v=(t[1].error||t[4])&&Bt(t);return{c(){e=d("div"),n=d("p"),s=u(m),i=p(),o=d("div"),y&&y.c(),f=p(),v&&v.c(),$(n,"class","label"),$(o,"class",l="control"+("password"===t[1].type?" has-icons-right":"")),$(e,"class","field"),$(e,"id",t[7])},m(t,l){a(t,e,l),r(e,n),r(n,s),r(e,i),r(e,o),y&&y.m(o,null),r(e,f),v&&v.m(e,null)},p(t,n){2&n&&m!==(m=t[1].label+"")&&b(s,m),g===(g=h(t))&&y?y.p(t,n):(y&&y.d(1),y=g&&g(t),y&&(y.c(),y.m(o,null))),2&n&&l!==(l="control"+("password"===t[1].type?" has-icons-right":""))&&$(o,"class",l),t[1].error||t[4]?v?v.p(t,n):(v=Bt(t),v.c(),v.m(e,null)):v&&(v.d(1),v=null)},d(t){t&&c(e),y&&y.d(),v&&v.d()}}}function Tt(t){let e,n,s=t[1].label+"";return{c(){e=d("p"),n=u(s),$(e,"class","label")},m(t,s){a(t,e,s),r(e,n)},p(t,e){2&e&&s!==(s=t[1].label+"")&&b(n,s)},d(t){t&&c(e)}}}function zt(t,e){let n,s,i,o,l,f,m=e[24].label+"";return{key:t,first:null,c(){n=d("option"),s=u(m),i=p(),n.__value=o=e[24].value,n.value=n.__value,n.selected=l=e[24].selected,n.disabled=f=e[24].disabled,this.first=n},m(t,e){a(t,n,e),r(n,s),r(n,i)},p(t,i){e=t,2&i&&m!==(m=e[24].label+"")&&b(s,m),2&i&&o!==(o=e[24].value)&&(n.__value=o,n.value=n.__value),2&i&&l!==(l=e[24].selected)&&(n.selected=l),2&i&&f!==(f=e[24].disabled)&&(n.disabled=f)},d(t){t&&c(n)}}}function Ht(t){let e,n,s=(t[1].error||t[4])+"";return{c(){e=d("p"),n=u(s),$(e,"class","help is-danger")},m(t,s){a(t,e,s),r(e,n)},p(t,e){18&e&&s!==(s=(t[1].error||t[4])+"")&&b(n,s)},d(t){t&&c(e)}}}function Vt(t){let e,n,i,o,l,u,f,h,g,b;return{c(){e=d("input"),l=p(),u=d("span"),f=d("i"),$(e,"type","password"),$(e,"class",n="input"+(t[1].error||t[4]?" is-danger":"")),$(e,"placeholder",i=t[1].placeholder),e.disabled=o=t[1].disabled,$(f,"class",h="fas "+(t[5]?"far fa-eye-slash":"fa-eye")),v(u,"position","absolute"),v(u,"top","50%"),v(u,"right","15px"),v(u,"transform","translateY(-50%)"),v(u,"cursor","pointer")},m(n,s){a(n,e,s),y(e,t[0]),t[19](e),a(n,l,s),a(n,u,s),r(u,f),g||(b=[m(e,"input",t[18]),m(e,"input",t[10]),m(u,"click",t[20])],g=!0)},p(t,s){18&s&&n!==(n="input"+(t[1].error||t[4]?" is-danger":""))&&$(e,"class",n),2&s&&i!==(i=t[1].placeholder)&&$(e,"placeholder",i),2&s&&o!==(o=t[1].disabled)&&(e.disabled=o),3&s&&e.value!==t[0]&&y(e,t[0]),32&s&&h!==(h="fas "+(t[5]?"far fa-eye-slash":"fa-eye"))&&$(f,"class",h)},d(n){n&&c(e),t[19](null),n&&c(l),n&&c(u),g=!1,s(b)}}}function Ut(t){let e,n,i,o,l,r;return{c(){e=d("input"),$(e,"type","number"),$(e,"class",n="input"+(t[1].error||t[4]?" is-danger":"")),$(e,"placeholder",i=t[1].placeholder),e.disabled=o=t[1].disabled,$(e,"min",t[2]),$(e,"max",t[3])},m(n,s){a(n,e,s),y(e,t[0]),l||(r=[m(e,"input",t[17]),m(e,"input",t[10])],l=!0)},p(t,s){18&s&&n!==(n="input"+(t[1].error||t[4]?" is-danger":""))&&$(e,"class",n),2&s&&i!==(i=t[1].placeholder)&&$(e,"placeholder",i),2&s&&o!==(o=t[1].disabled)&&(e.disabled=o),4&s&&$(e,"min",t[2]),8&s&&$(e,"max",t[3]),3&s&&g(e.value)!==t[0]&&y(e,t[0])},d(t){t&&c(e),l=!1,s(r)}}}function Gt(t){let e,n,i,o,l,r;return{c(){e=d("input"),$(e,"type","text"),$(e,"class",n="input"+(t[1].error||t[4]?" is-danger":"")),$(e,"placeholder",i=t[1].placeholder),e.disabled=o=t[1].disabled},m(n,s){a(n,e,s),y(e,t[0]),l||(r=[m(e,"input",t[16]),m(e,"input",t[10])],l=!0)},p(t,s){18&s&&n!==(n="input"+(t[1].error||t[4]?" is-danger":""))&&$(e,"class",n),2&s&&i!==(i=t[1].placeholder)&&$(e,"placeholder",i),2&s&&o!==(o=t[1].disabled)&&(e.disabled=o),3&s&&e.value!==t[0]&&y(e,t[0])},d(t){t&&c(e),l=!1,s(r)}}}function Yt(t){let e,n,i,o,l,r;return{c(){e=d("textarea"),$(e,"class",n="textarea"+(t[1].error||t[4]?" is-danger":"")),$(e,"placeholder",i=t[1].placeholder),e.disabled=o=t[1].disabled},m(n,s){a(n,e,s),y(e,t[0]),l||(r=[m(e,"input",t[15]),m(e,"input",t[10])],l=!0)},p(t,s){18&s&&n!==(n="textarea"+(t[1].error||t[4]?" is-danger":""))&&$(e,"class",n),2&s&&i!==(i=t[1].placeholder)&&$(e,"placeholder",i),2&s&&o!==(o=t[1].disabled)&&(e.disabled=o),3&s&&y(e,t[0])},d(t){t&&c(e),l=!1,s(r)}}}function Bt(t){let e,n,s=(t[1].error||t[4])+"";return{c(){e=d("p"),n=u(s),$(e,"class","help is-danger")},m(t,s){a(t,e,s),r(e,n)},p(t,e){18&e&&s!==(s=(t[1].error||t[4])+"")&&b(n,s)},d(t){t&&c(e)}}}function Wt(t){let e,n,s=t[1].tooltip+"";return{c(){e=d("span"),n=u(s),$(e,"class","tooltip__text")},m(t,s){a(t,e,s),r(e,n)},p(t,e){2&e&&s!==(s=t[1].tooltip+"")&&b(n,s)},d(t){t&&c(e)}}}function Xt(e){let n,s,i,o=e[1]&&Rt(e);return{c(){n=d("div"),s=p(),o&&o.c(),i=f(),this.c=t},m(t,l){a(t,n,l),n.innerHTML=e[11],a(t,s,l),o&&o.m(t,l),a(t,i,l)},p(t,[e]){t[1]?o?o.p(t,e):(o=Rt(t),o.c(),o.m(i.parentNode,i)):o&&(o.d(1),o=null)},i:t,o:t,d(t){t&&c(n),t&&c(s),o&&o.d(t),t&&c(i)}}}function Kt(t,e,n){const s=N();let{field:i}=e,{data:o}=e,{selected:l=0}=e,{invalid:r=!1}=e,{min:a}=e,{max:c}=e;const d=mt();let u;let p,f=!1;return t.$$set=t=>{"field"in t&&n(1,i=t.field),"data"in t&&n(0,o=t.data),"selected"in t&&n(12,l=t.selected),"invalid"in t&&n(13,r=t.invalid),"min"in t&&n(2,a=t.min),"max"in t&&n(3,c=t.max)},[o,i,a,c,u,f,p,d,()=>["text","number","password","textarea"].includes(i.type),function(t){s("input",t);const e=t.target;n(12,l=e.selectedIndex)},function(t){if(i.validator){const e=t.target;let s=i.validator(e.value);n(4,u="string"==typeof s?s:void 0),n(13,r=!!s)}s("input",t)},'\n<style>\n  @import url("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css");\n\n  .switch {\n    position: relative;\n    display: inline-block;\n    width: 60px;\n    height: 34px;\n  }\n\n  .switch .switch__input {\n    opacity: 0;\n    width: 0;\n    height: 0;\n  }\n\n  .slider {\n    position: absolute;\n    cursor: pointer;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: #ccc;\n    -webkit-transition: 0.4s;\n    transition: 0.4s;\n    border-radius: 34px;\n  }\n\n  .slider:before {\n    position: absolute;\n    content: "";\n    height: 26px;\n    width: 26px;\n    left: 4px;\n    bottom: 4px;\n    background-color: white;\n    -webkit-transition: 0.4s;\n    transition: 0.4s;\n    border-radius: 50%;\n  }\n\n  .switch__input:checked + .slider {\n    background-color: #2196f3;\n  }\n\n  .switch__input:checked + .slider {\n    box-shadow: 0 0 1px #2196f3;\n  }\n\n  .switch__input:checked + .slider:before {\n    -webkit-transform: translateX(26px);\n    -ms-transform: translateX(26px);\n    transform: translateX(26px);\n  }\n\n  .tooltip {\n    position: relative;\n  }\n\n  .tooltip__text {\n    position: absolute;\n    top: -20px;\n    left: 50%;\n    padding: 10px 15px;\n    border-radius: 5px;\n    background-color: rgba(51, 51, 51, 0.9);\n    color: white;\n    z-index: 9;\n    max-width: min(1000px, calc(100% - 30px));\n    display: block;\n\n    transition-property: opacity, transform, visibility;\n    transition-timing-function: ease;\n    transition-duration: 300ms;\n    pointer-events: none;\n    opacity: 0;\n    visibility: hidden;\n    transform: translateX(-50%) translateY(20px) scale(0);\n  }\n\n  .tooltip:hover > .tooltip__text {\n    pointer-events: all;\n    opacity: 1;\n    visibility: visible;\n    transform: translateX(-50%) translateY(0) scale(1);\n  }\n</style>\n',l,r,function(e){S.call(this,t,e)},function(){o=this.value,n(0,o),n(1,i)},function(){o=this.value,n(0,o),n(1,i)},function(){o=g(this.value),n(0,o),n(1,i)},function(){o=this.value,n(0,o),n(1,i)},function(t){P[t?"unshift":"push"]((()=>{p=t,n(6,p)}))},()=>{n(5,f=!f),n(6,p.type=f?"text":"password",p)},function(){o=this.checked,n(0,o),n(1,i)},function(){o=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this),n(0,o),n(1,i)}]}customElements.define("tf-select-profile",Ft);class Jt extends V{constructor(t){super(),nt(this,{target:this.shadowRoot,props:x(this.attributes),customElement:!0},Kt,Xt,o,{field:1,data:0,selected:12,invalid:13,min:2,max:3},null),t&&(t.target&&a(t.target,this,t.anchor),t.props&&(this.$set(t.props),O()))}static get observedAttributes(){return["field","data","selected","invalid","min","max"]}get field(){return this.$$.ctx[1]}set field(t){this.$$set({field:t}),O()}get data(){return this.$$.ctx[0]}set data(t){this.$$set({data:t}),O()}get selected(){return this.$$.ctx[12]}set selected(t){this.$$set({selected:t}),O()}get invalid(){return this.$$.ctx[13]}set invalid(t){this.$$set({invalid:t}),O()}get min(){return this.$$.ctx[2]}set min(t){this.$$set({min:t}),O()}get max(){return this.$$.ctx[3]}set max(t){this.$$set({max:t}),O()}}function Qt(t,e,n){const s=t.slice();return s[7]=e[n],s[9]=n,s}function Zt(t){let e,n=[],s=new Map,i=t[1];const o=t=>t[7].label;for(let e=0;e<i.length;e+=1){let l=Qt(t,i,e),r=o(l);s.set(r,n[e]=ee(r,l))}return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=f()},m(t,s){for(let e=0;e<n.length;e+=1)n[e].m(t,s);a(t,e,s)},p(t,l){51&l&&(i=t[1],n=K(n,l,o,1,t,i,s,e.parentNode,W,ee,e,Qt))},d(t){for(let e=0;e<n.length;e+=1)n[e].d(t);t&&c(e)}}}function te(t){let e,n,s;return{c(){e=d("button"),$(e,"class","ml-2 is-small delete")},m(o,l){var r;a(o,e,l),n||(s=m(e,"click",(r=h((function(){i(t[4](t[9]))&&t[4](t[9]).apply(this,arguments)})),function(t){return t.stopPropagation(),r.call(this,t)})),n=!0)},p(e,n){t=e},d(t){t&&c(e),n=!1,s()}}}function ee(t,e){let n,s,o,l,f,g,y,v,w,x=e[7].label+"",_=e[7].removable&&te(e);return{key:t,first:null,c(){n=d("li"),s=d("a"),o=d("span"),l=u(x),f=p(),_&&_.c(),g=p(),$(s,"href","#!"),$(n,"class",y=e[0]===e[7].value?"is-active":""),this.first=n},m(t,c){a(t,n,c),r(n,s),r(s,o),r(o,l),r(s,f),_&&_.m(s,null),r(n,g),v||(w=m(s,"click",h((function(){i(e[5].bind(void 0,e[7].value))&&e[5].bind(void 0,e[7].value).apply(this,arguments)}))),v=!0)},p(t,i){e=t,2&i&&x!==(x=e[7].label+"")&&b(l,x),e[7].removable?_?_.p(e,i):(_=te(e),_.c(),_.m(s,null)):_&&(_.d(1),_=null),3&i&&y!==(y=e[0]===e[7].value?"is-active":"")&&$(n,"class",y)},d(t){t&&c(n),_&&_.d(),v=!1,w()}}}function ne(e){let n,s,i,o,l=e[1]&&Zt(e);return{c(){n=d("div"),s=d("ul"),l&&l.c(),this.c=t,$(s,"style",i=e[3]?"pointer-events: none; cursor: default;":""),$(n,"class",o="tabs "+(e[2]?"is-centered":""))},m(t,e){a(t,n,e),r(n,s),l&&l.m(s,null)},p(t,[e]){t[1]?l?l.p(t,e):(l=Zt(t),l.c(),l.m(s,null)):l&&(l.d(1),l=null),8&e&&i!==(i=t[3]?"pointer-events: none; cursor: default;":"")&&$(s,"style",i),4&e&&o!==(o="tabs "+(t[2]?"is-centered":""))&&$(n,"class",o)},i:t,o:t,d(t){t&&c(n),l&&l.d()}}}function se(t,e,n){const s=N();let{tabs:i}=e,{active:o}=e,{centered:l=!0}=e,{disabled:r=!1}=e;return E((()=>{s("init")})),t.$$set=t=>{"tabs"in t&&n(1,i=t.tabs),"active"in t&&n(0,o=t.active),"centered"in t&&n(2,l=t.centered),"disabled"in t&&n(3,r=t.disabled)},[o,i,l,r,t=>()=>s("removed",t),function(t){o!==t&&(n(0,o=t),s("select",t))}]}customElements.define("tf-input",Jt);class ie extends V{constructor(t){super(),this.shadowRoot.innerHTML='<style>@import url("https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css");</style>',nt(this,{target:this.shadowRoot,props:x(this.attributes),customElement:!0},se,ne,o,{tabs:1,active:0,centered:2,disabled:3},null),t&&(t.target&&a(t.target,this,t.anchor),t.props&&(this.$set(t.props),O()))}static get observedAttributes(){return["tabs","active","centered","disabled"]}get tabs(){return this.$$.ctx[1]}set tabs(t){this.$$set({tabs:t}),O()}get active(){return this.$$.ctx[0]}set active(t){this.$$set({active:t}),O()}get centered(){return this.$$.ctx[2]}set centered(t){this.$$set({centered:t}),O()}get disabled(){return this.$$.ctx[3]}set disabled(t){this.$$set({disabled:t}),O()}}var oe,le;customElements.define("tf-tabs",ie);const{GridClient:re,Nodes:ae}=null!==(le=null===(oe=window.configs)||void 0===oe?void 0:oe.grid3_client)&&void 0!==le?le:{};var ce,de;const{GridClient:ue}=null!==(de=null===(ce=window.configs)||void 0===ce?void 0:ce.grid3_client)&&void 0!==de?de:{};function pe(t,e,n={}){const{networkEnv:s}=t,i=new ue("","","",null),{graphql:o}=i.getDefaultUrls(s);return fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e,variables:n})}).then((t=>t.json())).then((({data:t})=>t))}function fe(t,e,n){const s=t.slice();return s[30]=e[n],s}function me(t){let e,n,s,i,o,l;function r(e){t[23](e)}let d={field:t[12]};void 0!==t[0]&&(d.data=t[0]),e=new Jt({props:d}),P.push((()=>J(e,"data",r)));let u=t[8]&&t[0]&&$e(t),m=!t[8]&&t[0]&&ge(t);return{c(){Q(e.$$.fragment),s=p(),u&&u.c(),i=p(),m&&m.c(),o=f()},m(t,n){Z(e,t,n),a(t,s,n),u&&u.m(t,n),a(t,i,n),m&&m.m(t,n),a(t,o,n),l=!0},p(t,s){const l={};!n&&1&s[0]&&(n=!0,l.data=t[0],R((()=>n=!1))),e.$set(l),t[8]&&t[0]?u?u.p(t,s):(u=$e(t),u.c(),u.m(i.parentNode,i)):u&&(u.d(1),u=null),!t[8]&&t[0]?m?m.p(t,s):(m=ge(t),m.c(),m.m(o.parentNode,o)):m&&(m.d(1),m=null)},i(t){l||(Y(e.$$.fragment,t),l=!0)},o(t){B(e.$$.fragment,t),l=!1},d(t){tt(e,t),t&&c(s),u&&u.d(t),t&&c(i),m&&m.d(t),t&&c(o)}}}function he(t){let e,n,s,i,o,l,f,h,g,b,y,v,w,x=[],_=new Map,k=t[7];const I=t=>t[30].symbol;for(let e=0;e<k.length;e+=1){let n=fe(t,k,e),s=I(n);_.set(s,x[e]=ve(s,n))}function E(e){t[22](e)}let N={field:{label:`Node ID (Found ${t[5].options.length-1})`,type:"select",symbol:"nodeId",options:t[5].options}};return void 0!==t[0]&&(N.data=t[0]),g=new Jt({props:N}),P.push((()=>J(g,"data",E))),{c(){e=d("h5"),e.textContent="Nodes Filter",n=p();for(let t=0;t<x.length;t+=1)x[t].c();s=p(),i=d("button"),o=u("Apply filters and suggest nodes"),h=p(),Q(g.$$.fragment),$(e,"class","is-size-5 has-text-weight-bold"),$(i,"class",l="button is-primary mt-2 "+(t[6]?"is-loading":"")),i.disabled=f=t[6]||!t[3],$(i,"type","button")},m(l,c){a(l,e,c),a(l,n,c);for(let t=0;t<x.length;t+=1)x[t].m(l,c);a(l,s,c),a(l,i,c),r(i,o),a(l,h,c),Z(g,l,c),y=!0,v||(w=m(i,"click",t[10]),v=!0)},p(t,e){2192&e[0]&&(k=t[7],U(),x=K(x,e,I,1,t,k,_,s.parentNode,X,ve,s,fe),G()),(!y||64&e[0]&&l!==(l="button is-primary mt-2 "+(t[6]?"is-loading":"")))&&$(i,"class",l),(!y||72&e[0]&&f!==(f=t[6]||!t[3]))&&(i.disabled=f);const n={};32&e[0]&&(n.field={label:`Node ID (Found ${t[5].options.length-1})`,type:"select",symbol:"nodeId",options:t[5].options}),!b&&1&e[0]&&(b=!0,n.data=t[0],R((()=>b=!1))),g.$set(n)},i(t){if(!y){for(let t=0;t<k.length;t+=1)Y(x[t]);Y(g.$$.fragment,t),y=!0}},o(t){for(let t=0;t<x.length;t+=1)B(x[t]);B(g.$$.fragment,t),y=!1},d(t){t&&c(e),t&&c(n);for(let e=0;e<x.length;e+=1)x[e].d(t);t&&c(s),t&&c(i),t&&c(h),tt(g,t),v=!1,w()}}}function $e(t){let e,n,s;return{c(){e=d("p"),n=u("Validating node "),s=u(t[0]),$(e,"class","help is-success")},m(t,i){a(t,e,i),r(e,n),r(e,s)},p(t,e){1&e[0]&&b(s,t[0])},d(t){t&&c(e)}}}function ge(t){let e;function n(t,e){return"valid"==t[2]?ye:"invalid"===t[2]?be:void 0}let s=n(t),i=s&&s(t);return{c(){i&&i.c(),e=f()},m(t,n){i&&i.m(t,n),a(t,e,n)},p(t,o){s===(s=n(t))&&i?i.p(t,o):(i&&i.d(1),i=s&&s(t),i&&(i.c(),i.m(e.parentNode,e)))},d(t){i&&i.d(t),t&&c(e)}}}function be(t){let e,n,s,i,o;return{c(){e=d("p"),n=u("Node("),s=d("strong"),i=u(t[0]),o=u(") might be down or doesn't have enough\n        resources"),$(e,"class","help is-danger")},m(t,l){a(t,e,l),r(e,n),r(e,s),r(s,i),r(e,o)},p(t,e){1&e[0]&&b(i,t[0])},d(t){t&&c(e)}}}function ye(t){let e,n,s,i,o;return{c(){e=d("p"),n=u("Node("),s=d("strong"),i=u(t[0]),o=u(") is up and has enough resources"),$(e,"class","help is-success")},m(t,l){a(t,e,l),r(e,n),r(e,s),r(s,i),r(e,o)},p(t,e){1&e[0]&&b(i,t[0])},d(t){t&&c(e)}}}function ve(t,e){let n,s,o;return s=new Jt({props:{data:e[4][e[30].symbol],field:e[30]}}),s.$on("input",(function(){i(e[11](e[30].symbol))&&e[11](e[30].symbol).apply(this,arguments)})),{key:t,first:null,c(){n=f(),Q(s.$$.fragment),this.first=n},m(t,e){a(t,n,e),Z(s,t,e),o=!0},p(t,n){e=t;const i={};144&n[0]&&(i.data=e[4][e[30].symbol]),128&n[0]&&(i.field=e[30]),s.$set(i)},i(t){o||(Y(s.$$.fragment,t),o=!0)},o(t){B(s.$$.fragment,t),o=!1},d(t){t&&c(n),tt(s,t)}}}function we(e){let n,s,i,o,l,r,d;function u(t){e[21](t)}let m={field:e[9]};void 0!==e[1]&&(m.data=e[1]),n=new Jt({props:m}),P.push((()=>J(n,"data",u)));const h=[he,me],$=[];function g(t,e){return"automatic"===t[1]?0:"manual"===t[1]?1:-1}return~(o=g(e))&&(l=$[o]=h[o](e)),{c(){Q(n.$$.fragment),i=p(),l&&l.c(),r=f(),this.c=t},m(t,e){Z(n,t,e),a(t,i,e),~o&&$[o].m(t,e),a(t,r,e),d=!0},p(t,e){const i={};!s&&2&e[0]&&(s=!0,i.data=t[1],R((()=>s=!1))),n.$set(i);let a=o;o=g(t),o===a?~o&&$[o].p(t,e):(l&&(U(),B($[a],1,1,(()=>{$[a]=null})),G()),~o?(l=$[o],l?l.p(t,e):(l=$[o]=h[o](t),l.c()),Y(l,1),l.m(r.parentNode,r)):l=null)},i(t){d||(Y(n.$$.fragment,t),Y(l),d=!0)},o(t){B(n.$$.fragment,t),B(l),d=!1},d(t){tt(n,t),t&&c(i),~o&&$[o].d(t),t&&c(r)}}}function xe(t){return"number"!=typeof(t=+t)?"Please select a node.":t<1?"Please select a valid node":void 0}function _e(t,e,n){var s,i;const{GridClient:o}=null!==(i=null===(s=window.configs)||void 0===s?void 0:s.grid3_client)&&void 0!==i?i:{},l=N();let{cpu:r}=e,{memory:a}=e,{ssd:c}=e,{publicIp:d}=e,{data:u}=e,{status:p}=e,{nodes:f=[]}=e,{profile:m}=e,h=!1;const $=[{label:"Farm Name",symbol:"farmName",type:"select",placeholder:"Enter farm name",options:[{label:"Please select a farm",value:null,selected:!0}]},{label:"Country",symbol:"country",type:"select",placeholder:"Enter a country name",options:[{label:"Please select a country",value:null,selected:!0}]}],g={options:[{label:"Please select a node id.",value:null,selected:!0,disabled:!0}]};let b,{nodeSelection:y}=e,{filters:v}=e;function w(t,e="Loading..."){const s=$[t].options[0].label;return n(7,$[t].options[0].label=e,$),s}function x(t,e){const[s]=$[t].options;n(7,$[t].options=e.reduce(((t,{name:e,code:n})=>{const s={label:e,value:n||e};return t.push(s),t}),[s]),$)}const _={label:"Node ID",symbol:"nodeId",type:"number",placeholder:"Your Node ID",validator:xe};let k,I,E=!1;return t.$$set=t=>{"cpu"in t&&n(13,r=t.cpu),"memory"in t&&n(14,a=t.memory),"ssd"in t&&n(15,c=t.ssd),"publicIp"in t&&n(16,d=t.publicIp),"data"in t&&n(0,u=t.data),"status"in t&&n(2,p=t.status),"nodes"in t&&n(17,f=t.nodes),"profile"in t&&n(3,m=t.profile),"nodeSelection"in t&&n(1,y=t.nodeSelection),"filters"in t&&n(4,v=t.filters)},t.$$.update=()=>{if(122896&t.$$.dirty[0]&&v&&(r&&v.update("cru",r),a&&v.update("mru",Math.round(a/1024)),c&&v.update("sru",c),v.update("publicIPs",d)),131104&t.$$.dirty[0]){const[t]=g.options;n(5,g.options=[t,...f],g)}if(262154&t.$$.dirty[0]&&"automatic"===y&&m&&m.networkEnv!==b){n(18,b=m.networkEnv);const t=w(0),e=w(1);(function(t){return pe(t,"\nquery GetLimits {\n    farms: farmsConnection { farms_limit: totalCount }\n    countries: countriesConnection { countries_limit: totalCount }\n}\n").then((({farms:{farms_limit:t},countries:{countries_limit:e}})=>({farms_limit:t,countries_limit:e}))).then((e=>pe(t,"\nquery GetData($farms_limit: Int!, $countries_limit: Int!) {\n    farms(limit: $farms_limit) { name }\n    countries(limit: $countries_limit) { name code }\n}\n",e)))})(m).then((({farms:t,countries:e})=>{x(0,t),x(1,e)})).catch((t=>{console.log("Error",t)})).finally((()=>{w(0,t),w(1,e)}))}if(1572889&t.$$.dirty[0]&&m&&I!==u)if(xe(u)&&k)k.abort(),n(19,k=null),n(8,E=!1),n(2,p=null);else{n(20,I=u),k&&k.abort(),n(19,k=new AbortController);const{networkEnv:t}=m,e=new o("","","",null),{rmbProxy:s}=e.getDefaultUrls(t);n(8,E=!0),n(2,p=null),fetch(`${s}/nodes/${u}`,{method:"GET",signal:k.signal}).then((t=>t.json())).then((({capacity:t})=>{const{total:e,used:s}=t;if(e.cru-s.cru>=v.cru&&(e.sru-s.sru)/1024**3>=v.sru&&(e.mru-s.mru)/1024**3>=v.mru)return v.publicIPs?pe(m,"query getFarmId($id: Int!) { nodes(where: { nodeId_eq: $id }) { id: farmId }}",{id:u}).then((({nodes:[{id:t}]})=>pe(m,"query getIps($id: Int!) { publicIps(where: { contractId_eq: 0, farm: {farmId_eq: $id}}) {id}}",{id:t}))).then((({publicIps:t})=>{n(2,p=t.length>0?"valid":"invalid")})):void n(2,p="valid");n(2,p="invalid")})).catch((t=>{console.log("Error",t),t.message.includes("aborted a request")||n(2,p="invalid")})).finally((()=>{n(8,E=!1)}))}},[u,y,p,m,v,g,h,$,E,{label:"Node Selection",type:"select",symbol:"value",options:[{label:"Choose a way to select node",value:null,selected:!0,disabled:!0},{label:"Capacity filter",value:"automatic"},{label:"Manual",value:"manual"}]},function(){n(6,h=!0);const t=g.options[0].label;n(5,g.options[0].label="Loading...",g),function(t,e){return new Promise((async n=>{const{networkEnv:s}=e,i=new re("","","",null),{graphql:o,rmbProxy:l}=i.getDefaultUrls(s),r=new ae(o,l);try{n((await r.filterNodes(t)).map((t=>({label:`NodeID(${t.nodeId})`,value:t.nodeId}))))}catch(t){console.log("Error findNodes",t),n([])}}))}({publicIPs:v.publicIPs,country:v.country,farmName:v.farmName,cru:v.cru,mru:v.mru,sru:v.sru},m).then((t=>l("fetch",t))).catch((t=>console.log("Error",t))).finally((()=>{n(6,h=!1),n(5,g.options[0].label=t,g)}))},function(t){return e=>{const n=e.detail.target;v.update(t,n.value)}},_,r,a,c,d,f,b,k,I,function(t){y=t,n(1,y)},function(t){u=t,n(0,u)},function(t){u=t,n(0,u)}]}class ke extends V{constructor(t){super(),nt(this,{target:this.shadowRoot,props:x(this.attributes),customElement:!0},_e,we,o,{cpu:13,memory:14,ssd:15,publicIp:16,data:0,status:2,nodes:17,profile:3,nodeSelection:1,filters:4},null,[-1,-1]),t&&(t.target&&a(t.target,this,t.anchor),t.props&&(this.$set(t.props),O()))}static get observedAttributes(){return["cpu","memory","ssd","publicIp","data","status","nodes","profile","nodeSelection","filters"]}get cpu(){return this.$$.ctx[13]}set cpu(t){this.$$set({cpu:t}),O()}get memory(){return this.$$.ctx[14]}set memory(t){this.$$set({memory:t}),O()}get ssd(){return this.$$.ctx[15]}set ssd(t){this.$$set({ssd:t}),O()}get publicIp(){return this.$$.ctx[16]}set publicIp(t){this.$$set({publicIp:t}),O()}get data(){return this.$$.ctx[0]}set data(t){this.$$set({data:t}),O()}get status(){return this.$$.ctx[2]}set status(t){this.$$set({status:t}),O()}get nodes(){return this.$$.ctx[17]}set nodes(t){this.$$set({nodes:t}),O()}get profile(){return this.$$.ctx[3]}set profile(t){this.$$set({profile:t}),O()}get nodeSelection(){return this.$$.ctx[1]}set nodeSelection(t){this.$$set({nodeSelection:t}),O()}get filters(){return this.$$.ctx[4]}set filters(t){this.$$set({filters:t}),O()}}function Ie(t){let e,n,s,i,o,l,p,f,m,h=t[4].type+"",g=t[4].name+"";return{c(){e=d("div"),n=d("strong"),n.textContent="Warning!",s=u(" Another deployment of type\n        "),i=d("strong"),o=u(h),l=u("\n        with name "),p=d("strong"),f=u(g),m=u(" is in-progress."),$(e,"class","notification is-warning")},m(t,c){a(t,e,c),r(e,n),r(e,s),r(e,i),r(i,o),r(e,l),r(e,p),r(p,f),r(e,m)},p(t,e){16&e&&h!==(h=t[4].type+"")&&b(o,h),16&e&&g!==(g=t[4].name+"")&&b(f,g)},d(t){t&&c(e)}}}function Ee(e){let n;return{c(){n=d("div"),n.innerHTML="<strong>Warning!</strong> Make sure to not leave the page if there is an\n        in-progress deployment or deletion.",$(n,"class","notification is-warning")},m(t,e){a(t,n,e)},p:t,d(t){t&&c(n)}}}function Ne(t){let e;return{c(){e=u("Deploy")},m(t,n){a(t,e,n)},d(t){t&&c(e)}}}function Se(t){let e;return{c(){e=u("Back")},m(t,n){a(t,e,n)},d(t){t&&c(e)}}}function Ce(e){let n,s,i,o,l,u,f,h;function g(t,e){return t[0]?Ee:t[4]?Ie:void 0}let b=g(e),y=b&&b(e);function w(t,e){return t[1]||t[2]?Se:Ne}let x=w(e),_=x(e);return{c(){n=d("div"),s=d("div"),y&&y.c(),i=p(),o=d("button"),_.c(),this.c=t,v(s,"width","100%"),v(s,"padding-right","15px"),$(o,"class",l="button is-primary "+(e[0]?"is-loading":"")),$(o,"type","submit"),o.disabled=u=e[3]||!!e[4],$(n,"class","is-flex is-justify-content-space-between is-align-items-center")},m(t,l){a(t,n,l),r(n,s),y&&y.m(s,null),r(n,i),r(n,o),_.m(o,null),f||(h=m(o,"click",e[7]),f=!0)},p(t,[e]){b===(b=g(t))&&y?y.p(t,e):(y&&y.d(1),y=b&&b(t),y&&(y.c(),y.m(s,null))),x!==(x=w(t))&&(_.d(1),_=x(t),_&&(_.c(),_.m(o,null))),1&e&&l!==(l="button is-primary "+(t[0]?"is-loading":""))&&$(o,"class",l),24&e&&u!==(u=t[3]||!!t[4])&&(o.disabled=u)},i:t,o:t,d(t){t&&c(n),y&&y.d(),_.d(),f=!1,h()}}}function Pe(t,e,n){let s,i;var o;const r=null===(o=window.configs)||void 0===o?void 0:o.currentDeploymentStore;l(t,r,(t=>n(6,i=t)));let{loading:a}=e,{success:c}=e,{failed:d}=e,{disabled:u}=e;return t.$$set=t=>{"loading"in t&&n(0,a=t.loading),"success"in t&&n(1,c=t.success),"failed"in t&&n(2,d=t.failed),"disabled"in t&&n(3,u=t.disabled)},t.$$.update=()=>{64&t.$$.dirty&&n(4,s=i)},[a,c,d,u,s,r,i,function(e){S.call(this,t,e)}]}customElements.define("tf-select-node-id",ke);class Me extends V{constructor(t){super(),nt(this,{target:this.shadowRoot,props:x(this.attributes),customElement:!0},Pe,Ce,o,{loading:0,success:1,failed:2,disabled:3},null),t&&(t.target&&a(t.target,this,t.anchor),t.props&&(this.$set(t.props),O()))}static get observedAttributes(){return["loading","success","failed","disabled"]}get loading(){return this.$$.ctx[0]}set loading(t){this.$$set({loading:t}),O()}get success(){return this.$$.ctx[1]}set success(t){this.$$set({success:t}),O()}get failed(){return this.$$.ctx[2]}set failed(t){this.$$set({failed:t}),O()}get disabled(){return this.$$.ctx[3]}set disabled(t){this.$$set({disabled:t}),O()}}function De(t){let e;return{c(){e=d("div"),e.textContent="Your solution is now starting. Please be patient",$(e,"class","notification is-info")},m(t,n){a(t,e,n)},d(t){t&&c(e)}}}function je(e){let n,s,i,o,l,m=e[2]&&De();return{c(){n=d("div"),s=u(e[1]),o=p(),m&&m.c(),l=f(),this.c=t,$(n,"class",i="notification is-"+e[0])},m(t,e){a(t,n,e),r(n,s),a(t,o,e),m&&m.m(t,e),a(t,l,e)},p(t,[e]){2&e&&b(s,t[1]),1&e&&i!==(i="notification is-"+t[0])&&$(n,"class",i),t[2]?m||(m=De(),m.c(),m.m(l.parentNode,l)):m&&(m.d(1),m=null)},i:t,o:t,d(t){t&&c(n),t&&c(o),m&&m.d(t),t&&c(l)}}}function Fe(t,e,n){let{type:s}=e,{message:i}=e,{deployed:o=!1}=e;return t.$$set=t=>{"type"in t&&n(0,s=t.type),"message"in t&&n(1,i=t.message),"deployed"in t&&n(2,o=t.deployed)},[s,i,o]}customElements.define("tf-deploy-btn",Me);class Le extends V{constructor(t){super(),this.shadowRoot.innerHTML='<style>@import url("https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css");</style>',nt(this,{target:this.shadowRoot,props:x(this.attributes),customElement:!0},Fe,je,o,{type:0,message:1,deployed:2},null),t&&(t.target&&a(t.target,this,t.anchor),t.props&&(this.$set(t.props),O()))}static get observedAttributes(){return["type","message","deployed"]}get type(){return this.$$.ctx[0]}set type(t){this.$$set({type:t}),O()}get message(){return this.$$.ctx[1]}set message(t){this.$$set({message:t}),O()}get deployed(){return this.$$.ctx[2]}set deployed(t){this.$$set({deployed:t}),O()}}function Re(t){let e;return{c(){e=d("div"),e.textContent="Your solution is now starting. Please be patient",$(e,"class","notification is-info")},m(t,n){a(t,e,n)},d(t){t&&c(e)}}}function qe(e){let n,s,i,o,l,m,h,g,y,w,x,_,k,I,E,N,S,C,P,M,D,j,F=e[4]&&Re();return{c(){n=d("div"),s=u(e[1]),i=p(),o=d("hr"),l=p(),m=d("h3"),m.textContent="Deployment Info:",h=p(),g=d("ul"),y=d("li"),w=u("Domain: "),x=d("a"),_=u("https://"),k=u(e[2]),I=u("/"),N=p(),S=d("li"),C=u("Planetary IP: "),P=u(e[3]),D=p(),F&&F.c(),j=f(),this.c=t,v(m,"font-weight","bold"),$(x,"href",E=`https://${e[2]}/`),$(x,"target","_blank"),$(g,"class","ml-2"),$(n,"class",M="notification is-"+e[0])},m(t,e){a(t,n,e),r(n,s),r(n,i),r(n,o),r(n,l),r(n,m),r(n,h),r(n,g),r(g,y),r(y,w),r(y,x),r(x,_),r(x,k),r(x,I),r(g,N),r(g,S),r(S,C),r(S,P),a(t,D,e),F&&F.m(t,e),a(t,j,e)},p(t,[e]){2&e&&b(s,t[1]),4&e&&b(k,t[2]),4&e&&E!==(E=`https://${t[2]}/`)&&$(x,"href",E),8&e&&b(P,t[3]),1&e&&M!==(M="notification is-"+t[0])&&$(n,"class",M),t[4]?F||(F=Re(),F.c(),F.m(j.parentNode,j)):F&&(F.d(1),F=null)},i:t,o:t,d(t){t&&c(n),t&&c(D),F&&F.d(t),t&&c(j)}}}function Ae(t,e,n){let{type:s}=e,{message:i}=e,{domain:o}=e,{planetaryIP:l}=e,{deployed:r=!1}=e;return t.$$set=t=>{"type"in t&&n(0,s=t.type),"message"in t&&n(1,i=t.message),"domain"in t&&n(2,o=t.domain),"planetaryIP"in t&&n(3,l=t.planetaryIP),"deployed"in t&&n(4,r=t.deployed)},[s,i,o,l,r]}customElements.define("tf-alert",Le);class Oe extends V{constructor(t){super(),nt(this,{target:this.shadowRoot,props:x(this.attributes),customElement:!0},Ae,qe,o,{type:0,message:1,domain:2,planetaryIP:3,deployed:4},null),t&&(t.target&&a(t.target,this,t.anchor),t.props&&(this.$set(t.props),O()))}static get observedAttributes(){return["type","message","domain","planetaryIP","deployed"]}get type(){return this.$$.ctx[0]}set type(t){this.$$set({type:t}),O()}get message(){return this.$$.ctx[1]}set message(t){this.$$set({message:t}),O()}get domain(){return this.$$.ctx[2]}set domain(t){this.$$set({domain:t}),O()}get planetaryIP(){return this.$$.ctx[3]}set planetaryIP(t){this.$$set({planetaryIP:t}),O()}get deployed(){return this.$$.ctx[4]}set deployed(t){this.$$set({deployed:t}),O()}}customElements.define("tf-alert",Oe);const Te=/^[a-z0-9]+$/i;function ze(t){return 0===t.length?"Name must be at least 1 character":Te.test(t)?t.length>15?"Name must be at most 15 characters":void 0:"Name can only include alphanumeric characters"}function He(t){let e,n,s,i,o,l,r;function d(e){t[13](e)}e=new Ft({}),e.$on("profile",t[12]);let u={tabs:t[10]};void 0!==t[7]&&(u.active=t[7]),s=new ie({props:u}),P.push((()=>J(s,"active",d)));let m="base"===t[7]&&Ye(t);return{c(){Q(e.$$.fragment),n=p(),Q(s.$$.fragment),o=p(),m&&m.c(),l=f()},m(t,i){Z(e,t,i),a(t,n,i),Z(s,t,i),a(t,o,i),m&&m.m(t,i),a(t,l,i),r=!0},p(t,e){const n={};!i&&128&e&&(i=!0,n.active=t[7],R((()=>i=!1))),s.$set(n),"base"===t[7]?m?(m.p(t,e),128&e&&Y(m,1)):(m=Ye(t),m.c(),Y(m,1),m.m(l.parentNode,l)):m&&(U(),B(m,1,1,(()=>{m=null})),G())},i(t){r||(Y(e.$$.fragment,t),Y(s.$$.fragment,t),Y(m),r=!0)},o(t){B(e.$$.fragment,t),B(s.$$.fragment,t),B(m),r=!1},d(t){tt(e,t),t&&c(n),tt(s,t),t&&c(o),m&&m.d(t),t&&c(l)}}}function Ve(t){let e,n;return e=new Le({props:{type:"danger",message:t[8]||"Failed to deploy VM."}}),{c(){Q(e.$$.fragment)},m(t,s){Z(e,t,s),n=!0},p(t,n){const s={};256&n&&(s.message=t[8]||"Failed to deploy VM."),e.$set(s)},i(t){n||(Y(e.$$.fragment,t),n=!0)},o(t){B(e.$$.fragment,t),n=!1},d(t){tt(e,t)}}}function Ue(e){let n,s;return n=new Oe({props:{type:"success",message:"Successfully Deployed A Funkwhale Instance",planetaryIP:Pt,domain:Ct,deployed:!0}}),{c(){Q(n.$$.fragment)},m(t,e){Z(n,t,e),s=!0},p:t,i(t){s||(Y(n.$$.fragment,t),s=!0)},o(t){B(n.$$.fragment,t),s=!1},d(t){tt(n,t)}}}function Ge(t){let e,n;return e=new Le({props:{type:"info",message:t[8]||"Loading..."}}),{c(){Q(e.$$.fragment)},m(t,s){Z(e,t,s),n=!0},p(t,n){const s={};256&n&&(s.message=t[8]||"Loading..."),e.$set(s)},i(t){n||(Y(e.$$.fragment,t),n=!0)},o(t){B(e.$$.fragment,t),n=!1},d(t){tt(e,t)}}}function Ye(t){let e,n,s,i,o,l,r,d,u;function f(e){t[14](e)}function m(e){t[15](e)}let h={field:t[6]};function $(e){t[16](e)}function g(e){t[17](e)}function b(e){t[18](e)}void 0!==t[0].name&&(h.data=t[0].name),void 0!==t[6].invalid&&(h.invalid=t[6].invalid),e=new Jt({props:h}),P.push((()=>J(e,"data",f))),P.push((()=>J(e,"invalid",m)));let y={publicIp:!1,cpu:t[0].cpu,memory:t[0].memory,ssd:t[0].disks.reduce(We,t[0].rootFsSize),filters:t[0].selection.filters,profile:t[1],nodes:t[0].selection.nodes};return void 0!==t[0].nodeId&&(y.data=t[0].nodeId),void 0!==t[0].selection.type&&(y.nodeSelection=t[0].selection.type),void 0!==t[5]&&(y.status=t[5]),o=new ke({props:y}),P.push((()=>J(o,"data",$))),P.push((()=>J(o,"nodeSelection",g))),P.push((()=>J(o,"status",b))),o.$on("fetch",t[19]),{c(){Q(e.$$.fragment),i=p(),Q(o.$$.fragment)},m(t,n){Z(e,t,n),a(t,i,n),Z(o,t,n),u=!0},p(t,i){const a={};64&i&&(a.field=t[6]),!n&&1&i&&(n=!0,a.data=t[0].name,R((()=>n=!1))),!s&&64&i&&(s=!0,a.invalid=t[6].invalid,R((()=>s=!1))),e.$set(a);const c={};1&i&&(c.cpu=t[0].cpu),1&i&&(c.memory=t[0].memory),1&i&&(c.ssd=t[0].disks.reduce(We,t[0].rootFsSize)),1&i&&(c.filters=t[0].selection.filters),2&i&&(c.profile=t[1]),1&i&&(c.nodes=t[0].selection.nodes),!l&&1&i&&(l=!0,c.data=t[0].nodeId,R((()=>l=!1))),!r&&1&i&&(r=!0,c.nodeSelection=t[0].selection.type,R((()=>r=!1))),!d&&32&i&&(d=!0,c.status=t[5],R((()=>d=!1))),o.$set(c)},i(t){u||(Y(e.$$.fragment,t),Y(o.$$.fragment,t),u=!0)},o(t){B(e.$$.fragment,t),B(o.$$.fragment,t),u=!1},d(t){tt(e,t),t&&c(i),tt(o,t)}}}function Be(e){let n,s,i,o,l,u,f,g,b,y,w,x,_;const k=[Ge,Ue,Ve,He],I=[];function E(t,e){return t[2]?0:t[3]?1:t[4]?2:3}return f=E(e),g=I[f]=k[f](e),y=new Me({props:{disabled:e[9],loading:e[2],failed:e[4],success:e[3]}}),y.$on("click",e[20]),{c(){n=d("div"),s=d("form"),i=d("h4"),i.textContent="Deploy a Funkwhale Instance",o=p(),l=d("hr"),u=p(),g.c(),b=p(),Q(y.$$.fragment),this.c=t,$(i,"class","is-size-4"),$(s,"class","box"),v(n,"padding","15px")},m(t,c){a(t,n,c),r(n,s),r(s,i),r(s,o),r(s,l),r(s,u),I[f].m(s,null),r(s,b),Z(y,s,null),w=!0,x||(_=m(s,"submit",h(e[11])),x=!0)},p(t,[e]){let n=f;f=E(t),f===n?I[f].p(t,e):(U(),B(I[n],1,1,(()=>{I[n]=null})),G(),g=I[f],g?g.p(t,e):(g=I[f]=k[f](t),g.c()),Y(g,1),g.m(s,b));const i={};512&e&&(i.disabled=t[9]),4&e&&(i.loading=t[2]),16&e&&(i.failed=t[4]),8&e&&(i.success=t[3]),y.$set(i)},i(t){w||(Y(g),Y(y.$$.fragment,t),w=!0)},o(t){B(g),B(y.$$.fragment,t),w=!1},d(t){t&&c(n),I[f].d(),tt(y),x=!1,_()}}}const We=(t,e)=>t+e.size;function Xe(t,e,n){let s;var i,o,l;const{events:r}=null!==(o=null===(i=window.configs)||void 0===i?void 0:i.grid3_client)&&void 0!==o?o:{},a=null===(l=window.configs)||void 0===l?void 0:l.deploymentStore,c=new yt;let d,u,p="base",f=!1,m=!1,h=!1;const $={label:"Name",placeholder:"Virtual Machine Name",symbol:"name",type:"text",validator:ze,invalid:!1};let g;return t.$$.update=()=>{127&t.$$.dirty&&n(9,s=(f||!c.valid)&&!(m||h)||!d||$.invalid||"valid"!==u)},[c,d,f,m,h,u,$,p,g,s,[{label:"Base",value:"base"}],async function(){function t(t){"string"==typeof t&&n(8,g=t)}if(n(2,f=!0),n(3,m=!1),n(4,h=!1),n(8,g=void 0),!function(t,e=2){const{balance:n}=t;return n&&n>=e}(d))return n(4,h=!0),n(2,f=!1),void n(8,g="No enough balance to execute transaction requires 2 TFT at least in your wallet.");r.addListener("logs",t),Mt(c,d).then((()=>{a.set(0),n(3,m=!0),console.log(Ct),console.log(Pt)})).catch((t=>{n(4,h=!0),n(8,g="string"==typeof t?t:t.message)})).finally((()=>{n(2,f=!1),r.removeListener("logs",t)}))},({detail:t})=>{n(1,d=t),t&&n(0,c.envs[0]=new bt(void 0,"SSH_KEY",t.sshKey),c)},function(t){p=t,n(7,p)},function(e){t.$$.not_equal(c.name,e)&&(c.name=e,n(0,c))},function(e){t.$$.not_equal($.invalid,e)&&($.invalid=e,n(6,$))},function(e){t.$$.not_equal(c.nodeId,e)&&(c.nodeId=e,n(0,c))},function(e){t.$$.not_equal(c.selection.type,e)&&(c.selection.type=e,n(0,c))},function(t){u=t,n(5,u)},({detail:t})=>n(0,c.selection.nodes=t,c),t=>{(m||h)&&(t.preventDefault(),n(3,m=!1),n(4,h=!1),n(2,f=!1))}]}customElements.define("tf-funkwhale",class extends V{constructor(t){super(),this.shadowRoot.innerHTML='<style>@import url("https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css");</style>',nt(this,{target:this.shadowRoot,props:x(this.attributes),customElement:!0},Xe,Be,o,{},null),t&&t.target&&a(t.target,this,t.anchor)}})}();
